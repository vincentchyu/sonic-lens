# 仪表板增强和流派定制功能清单

## 概述

此特性增强了音乐播放统计系统的仪表板功能，添加了新的图表类型和交互功能，同时实现了流派名称的标准化处理。

## 功能特性

### 1. 仪表板增强功能

- **播放趋势图改进**：
    - 实现了气泡图可视化，显示每小时的播放数据
    - 添加了全屏显示功能，提升用户体验
    - 改进了数据处理逻辑，支持按日期和小时统计播放次数

- **新增流派图表**：
    - 添加了极坐标面积图展示热门流派数据
    - 实现了流派图表的全屏显示功能
    - 提供了流派详细信息的展示

### 2. 流派定制化

- **流派名称标准化**：
    - 实现了`GenreCustomFit`函数，用于标准化流派名称kanzhe
    - 添加了中英文流派名称映射处理
    - 支持去除流派名称末尾的"乐"字

### 3. API增强

- **新增API端点**：
    - `/api/dashboard/top-genres`：获取热门流派详细信息
    - 改进了`/api/dashboard/trend`端点，支持返回小时级播放趋势数据

### 4. 数据模型更新

- 扩展了数据模型以支持新的流派详细信息和播放趋势数据
- 添加了`HourlyPlayTrendData`结构体用于存储小时播放趋势数据

### 5. 单元测试

- 为`FillInTrendCycle`函数创建了单元测试

## 技术实现细节

### 前端增强

- 在`templates/dashboard.html`中添加了新的极坐标面积图用于展示流派数据
- 实现了趋势图和流派图的全屏显示功能
- 改进了图表的交互性和视觉效果

### 后端服务

- 在`api/server.go`中添加了新的API端点
- 实现了流派数据的获取和处理逻辑
- 增强了趋势数据的处理，支持小时级统计

### 数据处理

- 实现了`FillInTrendCycle`函数，用于填充趋势周期数据
- 添加了流派名称标准化处理函数
- 改进了数据模型以支持更丰富的元数据

## 文件变更

- `api/server.go`：添加新API端点和改进趋势数据处理
- `api/server_test.go`：添加单元测试
- `templates/dashboard.html`：增强仪表板UI，添加新图表和全屏功能
- `common/utils.go`：添加流派名称处理函数
- `internal/model/genre.go`：添加流派数据模型
- `internal/logic/genre/service.go`：实现流派服务逻辑
- 其他相关文件的更新和优化

## 测试

- 为新功能添加了单元测试
- 验证了API端点的正确性
- 测试了数据处理逻辑的准确性

## 依赖

- 使用Chart.js实现图表可视化
- 利用Gin框架处理HTTP请求